# CXL Type3 양산 테스트 프로그램 개발 계획

## 프로젝트 개요

**목표:** 강화학습 기반 메모리 셀 불량 검출로 양산 테스트 시간 단축 및 정확도 향상

**배경:**
- 현재 방식: stressapptest 약 10시간 실행
- 한계: 범용 스트레스 테스트로 특정 불량 패턴 타겟팅 불가
- 기회: MBIST 엔진 활용한 지능적 테스트로 시간 단축 가능

**핵심 가치:**
- ✅ 테스트 시간 대폭 단축 (10시간 → 목표: 1-2시간)
- ✅ 불량 검출 정확도 유지/향상
- ✅ 새로운 불량 패턴 발견 가능성

---

## Phase 1: 기존 불량 검출 검증 (Week 1-6)

### 목표
기존 알려진 불량 유형을 RL 에이전트가 효율적으로 검출하는지 검증

### 성공 기준
- [ ] **검출 정확도**: 기존 불량 100% 검출 (False Negative = 0)
- [ ] **테스트 시간**: 현재 대비 70% 이상 단축 (10시간 → 3시간 이하)
- [ ] **재현성**: 동일 불량에 대해 5회 테스트 시 5회 모두 검출

---

## 세부 일정

### Week 1-2: 현황 파악 및 준비

#### 1주차
- [ ] **불량 유형 조사** (진행 중)
  - 회사 기존 불량 데이터 수집
  - 불량 유형별 특징 분석
  - 각 불량을 검출하는 MBIST 알고리즘/패턴 파악

- [ ] **MBIST API 분석**
  - Montage MBIST 엔진 명령어 인터페이스 문서 확인
  - 현재 구현된 `src/mbist_interface.py` 검토
  - 실제 하드웨어 연동 테스트

#### 2주차
- [ ] **시뮬레이터 개선**
  - 실제 불량 패턴을 시뮬레이터에 구현
  - 불량 주입 메커니즘 추가
  - 검증: 시뮬레이터가 실제 불량 재현 가능한지 확인

- [ ] **Baseline 측정**
  - stressapptest 정확한 시간 측정
  - 검출률 측정 (가능하다면)
  - 결과 문서화

### Week 3-4: RL 에이전트 훈련

- [ ] **환경 설정 최적화**
  - Reward 함수 조정 (검출 정확도 우선)
  - Safety 파라미터 설정
  - 하이퍼파라미터 초기 설정

- [ ] **훈련 시작**
  - DQN 우선 훈련 (구현 단순, 샘플 효율 좋음)
  - PPO 병렬 훈련
  - 훈련 중 메트릭 모니터링

- [ ] **성능 분석**
  - 에피소드별 검출률 분석
  - 테스트 시간 측정
  - 알고리즘 비교 (DQN vs PPO)

### Week 5-6: 실제 하드웨어 검증

- [ ] **실제 환경 테스트**
  - 안전 모드 해제 전 체크리스트 확인
  - 실제 CXL Type3 디바이스에서 테스트
  - 안전 제한 설정 (최대 테스트 횟수, 쿨다운 등)

- [ ] **성능 검증**
  - 기존 불량 샘플로 검출 테스트
  - 검출 정확도 측정
  - 테스트 시간 측정

- [ ] **결과 분석 및 리포트**
  - Phase 1 성과 정리
  - stressapptest vs RL 방식 비교표 작성
  - Phase 2 전환 여부 결정

---

## Phase 2: 새로운 불량 패턴 탐색 (Week 7+)

### 조건
Phase 1에서 다음 조건 만족 시 진행:
- 기존 불량 검출률 95% 이상
- 테스트 시간 50% 이상 단축

### 목표
- Exploration 강화하여 미지의 불량 패턴 발견
- 온라인 학습으로 지속적 개선
- 양산 라인에 적용하며 실시간 학습

### 접근 방법
- Exploration rate 증가
- 새로운 알고리즘 조합 시도
- 발견된 새 패턴을 데이터베이스에 추가

---

## 기술 스택

### 하드웨어
- CXL Type3 Device (Samsung)
- Montage Controller (MBIST 엔진 내장)
- NVIDIA RTX 4060 Ti (훈련용)

### 소프트웨어
- Python 3.12
- PyTorch (강화학습)
- CUDA 12.8
- 강화학습 알고리즘: PPO, DQN

---

## 리스크 관리

### 리스크 1: 하드웨어 손상
- **대책**: Safety 모드에서 충분한 검증 후 실제 하드웨어 테스트
- **제한**: 최대 연속 테스트 횟수, 쿨다운 시간 설정

### 리스크 2: 검출 정확도 미달
- **대책**: Phase 1에서 기존 불량 검출 먼저 검증
- **Fallback**: 기존 방식 유지하면서 RL 보조 도구로 사용

### 리스크 3: 훈련 시간 과다
- **대책**: 시뮬레이터에서 대부분 훈련, 실제 하드웨어는 검증만
- **최적화**: GPU 활용, 배치 크기 조정

### 리스크 4: MBIST API 제약
- **대책**: API 문서 먼저 확인, 제약사항 파악
- **대안**: 가능한 명령어 범위 내에서 최적화

---

## KPI (Key Performance Indicators)

### Phase 1 목표

| 지표 | 현재 (Baseline) | 목표 | 측정 방법 |
|------|----------------|------|----------|
| **테스트 시간** | 10시간 | 3시간 이하 (70% 단축) | 평균 5회 측정 |
| **검출 정확도** | ? | 100% (기존 불량) | 알려진 불량 샘플 테스트 |
| **False Negative** | ? | 0% | 불량 놓침 횟수 |
| **재현성** | ? | 100% (5/5회) | 동일 불량 5회 테스트 |

### Phase 2 목표 (조건부)

| 지표 | 목표 |
|------|------|
| **새 패턴 발견** | 1개 이상 |
| **양산 적용** | 파일럿 라인 적용 |

---

## 현재 상태 (2025-10-31)

### 완료
- ✅ 프로젝트 구조 설계
- ✅ PPO, DQN 에이전트 구현
- ✅ 시뮬레이션 환경 구축
- ✅ 기본 MBIST 인터페이스 구현
- ✅ 실제 하드웨어 및 MBIST API 확보

### 진행 중
- 🔄 프로젝트 계획 수립
- 🔄 기존 불량 유형 조사

### 대기 중
- ⏳ MBIST API 상세 분석
- ⏳ 시뮬레이터 실제 불량 패턴 구현
- ⏳ RL 에이전트 훈련

---

## 다음 액션 아이템

### 즉시 수행 (이번 주)
1. **불량 유형 조사**
   - 회사 내부 데이터베이스 확인
   - 과거 불량 사례 수집
   - 불량별 특징 정리

2. **MBIST API 문서 확인**
   - Montage 컨트롤러 매뉴얼 검토
   - 사용 가능한 명령어 리스트 작성
   - `src/mbist_interface.py` 업데이트 필요사항 파악

3. **현재 코드 리뷰**
   - `src/mbist_interface.py` 실제 API 호출 구현 확인
   - 시뮬레이터 로직 점검
   - 개선 필요 사항 리스트업

---

## 의사결정 필요 사항

### 단기
- [ ] DQN vs PPO: 어느 알고리즘을 메인으로 할지?
  - 추천: DQN으로 시작, 성능 비교 후 결정

### 중기
- [ ] Phase 1 완료 기준: 정확히 어느 수준이면 통과?
  - 제안: 검출률 95% 이상, 시간 50% 단축

### 장기
- [ ] Phase 2 진행 여부
  - Phase 1 결과 보고 결정

---

## 참고 문서

- `README.md`: 프로젝트 전체 개요
- `DEPLOYMENT_GUIDE.md`: 배포 가이드
- `CLAUDE.md`: 프로젝트 배경 및 컨텍스트
- `docs/`: 추가 기술 문서

---

## 업데이트 이력

- 2025-10-31: 초안 작성, Phase 1-2 계획 수립
